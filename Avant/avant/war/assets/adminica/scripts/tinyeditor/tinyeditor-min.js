function T$(e){return document.getElementById(e)}function T$$$(){return document.all?1:0}TINY={};TINY.editor=function(){function n(n,r){this.n=n;window[n]=this;this.t=T$(r.id);this.obj=r;this.xhtml=r.xhtml;var i=document.createElement("div"),s=document.createElement("div"),o=document.createElement("div"),u=r.controls.length,a=0;this.i=document.createElement("iframe");this.i.frameBorder=0;this.i.width=r.width||"500";this.i.height=r.height||"250";this.ie=T$$$();o.className=r.rowclass||"teheader";i.className=r.cssclass||"te";i.style.width=this.i.width+"px";i.appendChild(o);for(a;a<u;a++){var f=r.controls[a];if(f=="n"){o=document.createElement("div");o.className=r.rowclass||"teheader";i.appendChild(o)}else if(f=="|"){var l=document.createElement("div");l.className=r.dividerclass||"tedivider";o.appendChild(l)}else if(f=="font"){var h=document.createElement("select"),p=r.fonts||["Verdana","Arial","Georgia"],d=p.length,v=0;h.className="tefont";h.onchange=new Function(this.n+'.ddaction(this,"fontname")');h.options[0]=new Option("Font","");for(v;v<d;v++){var m=p[v];h.options[v+1]=new Option(m,m)}o.appendChild(h)}else if(f=="size"){var h=document.createElement("select"),g=r.sizes||[1,2,3,4,5,6,7],y=g.length,v=0;h.className="tesize";h.onchange=new Function(this.n+'.ddaction(this,"fontsize")');for(v;v<y;v++){var b=g[v];h.options[v]=new Option(b,b)}o.appendChild(h)}else if(f=="style"){var h=document.createElement("select"),w=r.styles||[["Style",""],["Paragraph","<p>"],["Header 1","<h1>"],["Header 2","<h2>"],["Header 3","<h3>"],["Header 4","<h4>"],["Header 5","<h5>"],["Header 6","<h6>"]],y=w.length,v=0;h.className="testyle";h.onchange=new Function(this.n+'.ddaction(this,"formatblock")');for(v;v<y;v++){var E=w[v];h.options[v]=new Option(E[0],E[1])}o.appendChild(h)}else if(e[f]){var S=document.createElement("div"),v=e[f],x=v[2],T,N=v[0]*t;S.className=r.controlclass;S.style.backgroundPosition="0px "+N+"px";S.title=v[1];T=x=="a"?'.action("'+v[3]+'",0,'+(v[4]||0)+")":'.insert("'+v[4]+'","'+v[5]+'","'+v[3]+'")';S.onclick=new Function(this.n+(f=="print"?".print()":T));S.onmouseover=new Function(this.n+".hover(this,"+N+",1)");S.onmouseout=new Function(this.n+".hover(this,"+N+",0)");o.appendChild(S);this.ie&&(S.unselectable="on")}}this.t.parentNode.insertBefore(i,this.t);this.t.style.width=this.i.width+"px";s.appendChild(this.t);s.appendChild(this.i);i.appendChild(s);this.t.style.display="none";if(r.footer){var C=document.createElement("div");C.className=r.footerclass||"tefooter";if(r.toggle){var k=r.toggle,L=document.createElement("div");L.className=k.cssclass||"toggle";L.innerHTML=r.toggletext||"source";L.onclick=new Function(this.n+".toggle(0,this);return false");C.appendChild(L)}if(r.resize){var A=r.resize,O=document.createElement("div");O.className=A.cssclass||"resize";O.onmousedown=new Function("event",this.n+".resize(event);return false");O.onselectstart=function(){return!1};C.appendChild(O)}i.appendChild(C)}this.e=this.i.contentWindow.document;this.e.open();var M="<html><head>",_=r.bodyid?' id="'+r.bodyid+'"':"";r.cssfile&&(M+='<link rel="stylesheet" href="'+r.cssfile+'" />');r.css&&(M+='<style type="text/css">'+r.css+"</style>");M+="</head><body"+_+">"+(r.content||this.t.value);M+="</body></html>";this.e.write(M);this.e.close();this.e.designMode="on";this.d=1;if(this.xhtml)try{this.e.execCommand("styleWithCSS",0,0)}catch(D){try{this.e.execCommand("useCSS",0,1)}catch(D){}}}var e=[],t=-30;e.cut=[1,"Cut","a","cut",1];e.copy=[2,"Copy","a","copy",1];e.paste=[3,"Paste","a","paste",1];e.bold=[4,"Bold","a","bold"];e.italic=[5,"Italic","a","italic"];e.underline=[6,"Underline","a","underline"];e.strikethrough=[7,"Strikethrough","a","strikethrough"];e.subscript=[8,"Subscript","a","subscript"];e.superscript=[9,"Superscript","a","superscript"];e.orderedlist=[10,"Insert Ordered List","a","insertorderedlist"];e.unorderedlist=[11,"Insert Unordered List","a","insertunorderedlist"];e.outdent=[12,"Outdent","a","outdent"];e.indent=[13,"Indent","a","indent"];e.leftalign=[14,"Left Align","a","justifyleft"];e.centeralign=[15,"Center Align","a","justifycenter"];e.rightalign=[16,"Right Align","a","justifyright"];e.blockjustify=[17,"Block Justify","a","justifyfull"];e.undo=[18,"Undo","a","undo"];e.redo=[19,"Redo","a","redo"];e.image=[20,"Insert Image","i","insertimage","Enter Image URL:","http://"];e.hr=[21,"Insert Horizontal Rule","a","inserthorizontalrule"];e.link=[22,"Insert Hyperlink","i","createlink","Enter URL:","http://"];e.unlink=[23,"Remove Hyperlink","a","unlink"];e.unformat=[24,"Remove Formatting","a","removeformat"];e.print=[25,"Print","a","print"];n.prototype.print=function(){this.i.contentWindow.print()},n.prototype.hover=function(e,t,n){e.style.backgroundPosition=(n?"34px ":"0px ")+t+"px"},n.prototype.ddaction=function(e,t){var n=e.selectedIndex,r=e.options[n].value;this.action(t,r)},n.prototype.action=function(e,t,n){n&&!this.ie?alert("Your browser does not support this function."):this.e.execCommand(e,0,t||null)},n.prototype.insert=function(e,t,n){var r=prompt(e,t);r!=null&&r!=""&&this.e.execCommand(n,0,r)},n.prototype.setfont=function(){execCommand("formatblock",0,hType)},n.prototype.resize=function(e){this.mv&&this.freeze();this.i.bcs=TINY.cursor.top(e);this.mv=new Function("event",this.n+".move(event)");this.sr=new Function(this.n+".freeze()");if(this.ie){document.attachEvent("onmousemove",this.mv);document.attachEvent("onmouseup",this.sr)}else{document.addEventListener("mousemove",this.mv,1);document.addEventListener("mouseup",this.sr,1)}},n.prototype.move=function(e){var t=TINY.cursor.top(e);this.i.height=parseInt(this.i.height)+t-this.i.bcs;this.i.bcs=t},n.prototype.freeze=function(){if(this.ie){document.detachEvent("onmousemove",this.mv);document.detachEvent("onmouseup",this.sr)}else{document.removeEventListener("mousemove",this.mv,1);document.removeEventListener("mouseup",this.sr,1)}},n.prototype.toggle=function(e,t){if(!this.d){var n=this.t.value;t&&(t.innerHTML=this.obj.toggletext||"source");if(this.xhtml&&!this.ie){n=n.replace(/<strong>(.*)<\/strong>/gi,'<span style="font-weight: bold;">$1</span>');n=n.replace(/<em>(.*)<\/em>/gi,'<span style="font-weight: italic;">$1</span>')}this.e.body.innerHTML=n;this.t.style.display="none";this.i.style.display="block";this.d=1}else{var n=this.e.body.innerHTML;if(this.xhtml){n=n.replace(/<span class="apple-style-span">(.*)<\/span>/gi,"$1");n=n.replace(/ class="apple-style-span"/gi,"");n=n.replace(/<span style="">/gi,"");n=n.replace(/<br>/gi,"<br />");n=n.replace(/<br ?\/?>$/gi,"");n=n.replace(/^<br ?\/?>/gi,"");n=n.replace(/(<img [^>]+[^\/])>/gi,"$1 />");n=n.replace(/<b\b[^>]*>(.*?)<\/b[^>]*>/gi,"<strong>$1</strong>");n=n.replace(/<i\b[^>]*>(.*?)<\/i[^>]*>/gi,"<em>$1</em>");n=n.replace(/<u\b[^>]*>(.*?)<\/u[^>]*>/gi,'<span style="text-decoration:underline">$1</span>');n=n.replace(/<(b|strong|em|i|u) style="font-weight: normal;?">(.*)<\/(b|strong|em|i|u)>/gi,"$2");n=n.replace(/<(b|strong|em|i|u) style="(.*)">(.*)<\/(b|strong|em|i|u)>/gi,'<span style="$2"><$4>$3</$4></span>');n=n.replace(/<span style="font-weight: normal;?">(.*)<\/span>/gi,"$1");n=n.replace(/<span style="font-weight: bold;?">(.*)<\/span>/gi,"<strong>$1</strong>");n=n.replace(/<span style="font-style: italic;?">(.*)<\/span>/gi,"<em>$1</em>");n=n.replace(/<span style="font-weight: bold;?">(.*)<\/span>|<b\b[^>]*>(.*?)<\/b[^>]*>/gi,"<strong>$1</strong>")}t&&(t.innerHTML=this.obj.toggletext||"wysiwyg");this.t.value=n;if(!e){this.t.style.height=this.i.height+"px";this.i.style.display="none";this.t.style.display="block";this.d=0}}},n.prototype.post=function(){this.d&&this.toggle(1)};return{edit:n}}();TINY.cursor=function(){return{top:function(e){return T$$$()?window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop:e.clientY+window.scrollY}}}();