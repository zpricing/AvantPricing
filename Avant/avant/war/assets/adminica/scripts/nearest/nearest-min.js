(function(e,t){function n(t,n,r){t||(t="div");var i=e(t),s=[],o=!!n.furthest,u=!!n.checkHoriz,a=!!n.checkVert,f=o?0:Infinity,l=parseFloat(n.x)||0,c=parseFloat(n.y)||0,h=parseFloat(l+n.w)||l,p=parseFloat(c+n.h)||c,d=n.tolerance||0,v=!!e.fn.each2,m=Math.min,g=Math.max;!n.includeSelf&&r&&(i=i.not(r));d<0&&(d=0);i[v?"each2":"each"](function(t,n){var r=v?n:e(this),i=r.offset(),y=i.left,b=i.top,w=r.outerWidth(),E=r.outerHeight(),S=y+w,x=b+E,T=g(y,l),N=m(S,h),C=g(b,c),k=m(x,p),L=N>=T,A=k>=C,O,M,_,D;if(u&&a||!u&&!a&&L&&A||u&&A||a&&L){O=L?0:T-N;M=A?0:C-k;_=L||A?g(O,M):Math.sqrt(O*O+M*M);D=o?_>=f-d:_<=f+d;if(D){f=o?g(f,_):m(f,_);s.push({node:this,dist:_})}}});var y=s.length,b=[],w,E,S,x;if(y){if(o){w=f-d;E=f}else{w=f;E=f+d}for(S=0;S<y;S++){x=s[S];x.dist>=w&&x.dist<=E&&b.push(x.node)}}return b}e.each(["nearest","furthest","touching"],function(r,i){var s={x:0,y:0,w:0,h:0,tolerance:1,furthest:i=="furthest",includeSelf:!1,checkHoriz:i!="touching",checkVert:i!="touching"};e[i]=function(r,i,o){if(!r||r.x===t||r.y===t)return e([]);var u=e.extend({},s,r,o||{});return e(n(i,u))};e.fn[i]=function(t,r){var i;if(t&&e.isPlainObject(t)){i=e.extend({},s,t,r||{});return this.pushStack(n(this,i))}var o=this.offset(),u={x:o.left,y:o.top,w:this.outerWidth(),h:this.outerHeight()};i=e.extend({},s,u,r||{});return this.pushStack(n(t,i,this))}})})(jQuery);